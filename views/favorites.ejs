<!DOCTYPE html>
<html>

<head>
    <title>Favorites</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>

<body class="bg-light">

    <div class="container mt-4">

        <!-- Header -->
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2>YouTube Favorites</h2>

            <div>
                <span class="me-3">
                    Hello, <b>
                        <%= user.fullName %>
                    </b>
                </span>

                <form method="POST" action="/logout" class="d-inline">
                    <button class="btn btn-outline-danger btn-sm">Logout</button>
                </form>
            </div>
        </div>

        <!-- Search -->
        <form method="POST" action="/favorites/search" class="mb-4">
            <div class="input-group">
                <input type="text" name="query" class="form-control" placeholder="Search YouTube..."
                    value="<%= query %>" required />
                <button class="btn btn-primary">Search</button>
            </div>
        </form>

        <!-- Search results -->
        <% if (videos.length> 0) { %>
            <h4>Search Results</h4>
            <div class="row mb-4">
                <% videos.forEach(video=> { %>
                    <div class="col-md-4 mb-3">
                        <div class="card h-100">
                            <img src="<%= video.thumbnail %>" class="card-img-top">
                            <div class="card-body">
                                <h6 class="card-title">
                                    <%= video.title %>
                                </h6>

                                <form method="POST" action="/favorites/add">
                                    <input type="hidden" name="videoId" value="<%= video.videoId %>">
                                    <input type="hidden" name="title" value="<%= video.title %>">
                                    <input type="hidden" name="thumbnail" value="<%= video.thumbnail %>">
                                    <button class="btn btn-success btn-sm">Add to favorites</button>
                                </form>
                            </div>
                        </div>
                    </div>
                    <% }) %>
            </div>
            <% } %>

                <!-- Favorites list -->
                <h4>Your Favorites</h4>

                <% if (favorites.length===0) { %>
                    <p class="text-muted">No favorites yet.</p>
                    <% } else { %>
                        <div class="row">
                            <% favorites.forEach(video=> { %>
                                <div class="col-md-4 mb-3">
                                    <div class="card h-100 border-success">
                                        <img src="<%= video.thumbnail %>" class="card-img-top">
                                        <div class="card-body">
                                            <h6 class="card-title">
                                                <%= video.title %>
                                            </h6>

                                            <form method="POST" action="/favorites/remove">
                                                <input type="hidden" name="videoId" value="<%= video.videoId %>">
                                                <button class="btn btn-danger btn-sm">Remove</button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                                <% }) %>
                        </div>
                        <% } %>

    </div>

</body>

</html>